<!DOCTYPE html>
<!-- TDOO: remove <var>s in graphie data-eachs -->
<html data-require="math expressions graphie">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>Even and odd functions</title>
    <script src="../khan-exercise.js"></script>
    <script type="text/javascript">
        function makeFunc(type) {
            var slice;

            var funcs = {
                "Even": [
                    function(x) { return 1; },
                    function(x) { return 2 * Math.cos(x); },
                    Math.abs,
                    function(x) { return x * x; },
                    function(x) { return x * x * x * x; }],
                "Odd": [
                    function(x) { return 2 * Math.sin(x); },
                    function(x) { return x; },
                    function(x) { return x * x * x; },
                    function(x) { return x * x * x * x * x; }]
            }

            var r1 = KhanUtil.randRangeNonZero(-3, 3);
            var r2 = KhanUtil.randRange(-3, 3);
            var r3 = KhanUtil.randRange(-3, 3);
            var r4;

            // Choose four even functions or four odd functions if we want a function
            // that is even or odd respectively.
            if (type === "Even" || type === "Odd") {
                r4 = KhanUtil.randRange(-3, 3);
                slice = KhanUtil.shuffle(funcs[type]).slice(0, 4);

            // Choose two even and two odd functions if we want a function that
            // is neither even nor odd.
            } else {
                r4 = KhanUtil.randRangeNonZero(-3, 3);
                slice = KhanUtil.shuffle(funcs['Even']).slice(0, 2).concat(
                        KhanUtil.shuffle(funcs['Odd']).slice(0, 2));
            }

            var f = function(x) {
                return slice[0](x) * r1 + slice[1](x) * r2 + slice[2](x) * r3 + slice[3](x) * r4;
            };

            // Scale function so that f(x) is between -10 and +10 for x = -10 to +10
            var s;
            for (s=0; s<10; s++) {
                if (Math.abs(f(s)) > 10) {
                    break;
                }
            }

            return function(x) { return f(x * s / 10); };
        };

        // Get the x-coordinates that we will use to show the function's value in hints.
        // Filter out any points where the function is offscreen or both the pos and neg values are too close to zero.
        function getUseablePoints(func, type) {
            var arr = $.grep([1,2,3,4,5,6,7,8,9,10], function(i) {
                    return (Math.abs(func(i)) > 1 || Math.abs(func(-i)) > 1) && Math.abs(func(i)) < 10 && Math.abs(func(-i)) < 10;
                })

            // Filter further to remove any coordinate that would look kind of like it was even or odd.
            // Also filter out 10 because that makes displaying things easier.
            if (type === 'Neither') {
                arr = $.grep(arr, function(i) {
                        return Math.abs(Math.abs(func(i)) - Math.abs(func(-i))) > 0.5 && Math.abs(i) < 10;
                    })
            }

            return arr;
        };
    </script>
</head>
<body>
    <div class="exercise">
        <div class="vars">
            <!-- FIXME: replace with ul when that's fixed -->
            <var id="SOL">randFromArray(["Even", "Odd", "Neither"])</var>
            <var id="FUNC">makeFunc(SOL)</var>
            <var id="X_VALUES">getUseablePoints(FUNC, SOL)</var>
            <var id="Y_VALUES">$.map(X_VALUES, function(x) { return roundTo(1, FUNC(x)); }) </var>
            <var id="PT">randFromArray(X_VALUES)</var>
        </div>

        <div class="problems">
            <div>
                <div class="problem">
                    <p><code>f(x)</code> is graphed below.</p>
                    <div class="graphie" id="graph">
                        graphInit({
                            range: 10,
                            scale: 20,
                            tickStep: 1,
                            axisArrows: "&lt;-&gt;"
                        });

                        style({
                            stroke: BLUE
                        });

                        plot(function(x) {
                            return FUNC(x);
                        }, [-10, 10]);

                        style({
                            stroke: RED
                        });
                    </div>
                </div>

                <p class="question">Is <code>f(x)</code> even, odd, or neither?</p>
                <p class="solution"><var>SOL</var></p>
                <ul class="choices" data-category="true">
                    <li>Even</li>
                    <li>Odd</li>
                    <li>Neither</li>
                </ul>
            </div>
        </div>

        <div class="hints">
            <div>
                <div>A function is even is <code>f(x) = f(-x)</code>.</div>
                <div>A function is odd is <code>f(x) = -f(-x)</code>.</div>
            </div>

            <div data-if="SOL === 'Neither'" data-unwrap="">
                <div>
                    <div class="graphie" data-update="graph">
                        style(
                            { strokeWidth: 2 },
                            function() {
                                path([[ PT, 0], [ PT, FUNC(PT)]]);
                                path([[-PT, 0], [-PT, FUNC(-PT)]]);
                            }
                        );

                        style(
                            { strokeDasharray: "." },
                            function() {
                                path([[0, FUNC(PT)], [PT, FUNC(PT)]]);
                                path([[0, FUNC(-PT)], [-PT, FUNC(-PT)]]);
                            }
                        );

                        label([ PT, 0], PT, "below right");
                        label([-PT, 0], -PT, "below left");

                        label([0, FUNC(PT)], "f(a)", "left");
                        label([0, FUNC(-PT)], "f(-a)", "right");
                    </div>

                    <p>
                        <div><code>\qquad f(<var>PT</var>) \approx <var>roundTo(1, FUNC(PT))</var></code></div>
                        <div><code>\qquad f(<var>-PT</var>) \approx <var>roundTo(1, FUNC(-PT))</var></code></div>
                    </p>

                </div>

                <p><code>f(<var>PT</var>) \neq f(<var>-PT</var>)</code>, so <code>f(x)</code> is not even.</p>

                <p><code>f(<var>PT</var>) \neq -f(<var>-PT</var>)</code>, so <code>f(x)</code> is not odd.</p>

                <p>Therefore <code>f(x)</code> is neither.</p>

            </div>

            <div data-else="" data-unwrap="">

                <div data-each="X_VALUES as x" data-unwrap="">

                    <div class="graphie" data-update="graph">
                        style(
                            { stroke: RED },
                            function() {
                                path([[ x, 0], [ x, FUNC(x)]]);
                                path([[-x, 0], [-x, FUNC(-x)]]);
                            }
                        );
                    </div>

                    <div class="graphie" data-update="graph">
                        style(
                            { strokeDasharray: "." },
                            function() {
                                path([[0, FUNC(x)], [x, FUNC(x)]]);
                                path([[0, FUNC(-x)], [-x, FUNC(-x)]]);
                            }
                        );
                    </div>

                </div>

                <div data-if="SOL === 'Odd'">
                    <p><code>f(-a)=-f(a)</code> for all of these points, so <code>f(x)</code> is <span class="hint_blue">odd</span>.</p>
                </div>

                <div data-else="">
                    <p><code>f(-a)=f(a)</code> for all of these points, so <code>f(x)</code> is <span class="hint_blue">even</span>.</p>
                </div>

            </div>

        </div>

    </div>
</body>
</html>
